<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <title>Nicks polishändelser 1.0</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 980px; margin: 20px auto; background:#f6f7f9; }
    .header { text-align:center; margin-bottom:12px; }
    .controls { background:#fff; padding:12px; border-radius:8px; margin-bottom:16px; box-shadow:0 1px 4px rgba(0,0,0,0.06); }
    .controls form { display:flex; flex-wrap:wrap; gap:8px; align-items:center; justify-content:center; }
    select,input { padding:6px 8px; font-size:0.95rem; }
    button { padding:7px 10px; cursor:pointer; }
    .event { background:#fff; padding:12px; border-radius:8px; margin-bottom:10px; box-shadow:0 2px 6px rgba(0,0,0,0.06); }
    .meta { color:#555; font-size:0.95rem; margin-bottom:6px; }
    .summary { color:#222; }
    .noevents { text-align:center; color:#666; padding:20px; }
    .footer { text-align:center; color:#666; margin-top:16px; font-size:0.9rem; }
  </style>
</head>
<body>
  <div class="header">
    <h1>Nicks polishändelser 1.0</h1>
    <p>{{ count }} händelser hittades</p>
  </div>
  
<p><a href="/manage">⚙️ Hantera allvarlighetsgrader</a></p>

  <div class="controls">
    <form method="POST">
      <label>Period:</label>
      <select name="hours">
        <option value="3" {% if selected_hours=='3' %}selected{% endif %}>3 timmar</option>
        <option value="6" {% if selected_hours=='6' %}selected{% endif %}>6 timmar</option>
        <option value="12" {% if selected_hours=='12' %}selected{% endif %}>12 timmar</option>
        <option value="24" {% if selected_hours=='24' %}selected{% endif %}>24 timmar</option>
        <option value="all" {% if selected_hours=='all' %}selected{% endif %}>Alla</option>
      </select>

      <label>Sortera efter allvarlighetsgrad (1-10):</label>
      <select name="min_seriousness">
        {% for i in range(0,11) %}
          <option value="{{ i }}" {% if min_seriousness==i %}selected{% endif %}>{{ i }}</option>
        {% endfor %}
      </select>

      <label>Sökord:</label>
      <input type="text" name="keyword" placeholder="mord, explosion..." value="{{ keyword }}">

      <label>Plats:</label>
      <input type="text" name="location" placeholder="stad eller ort" value="{{ location }}">

      <button type="submit">Visa</button>
    </form>
  </div>

  {% if events %}
    {% for e in events %}
      <div class="event">
        <div class="meta">
          🕒 {{ e.time.strftime('%Y-%m-%d %H:%M') if e.time else 'Okänd tid' }}
          &nbsp; | &nbsp; 📍 {{ e.location_name }}
          &nbsp; | &nbsp; 🚨 {{ e.type }}
          &nbsp; | &nbsp; ⚠️ {{ e.seriousness }}
        </div>
        <div class="summary">📝 {{ e.summary }}</div>
        <div style="margin-top:8px;">
          <a href="https://polisen.se{{ e.url }}" target="_blank">🔗 Läs mer</a>
        </div>
      </div>
    {% endfor %}
  {% else %}
    <div class="noevents">🚫 Inga händelser hittades.</div>
  {% endif %}

  <div class="footer">
    Byt filter och tryck Visa för att uppdatera resultatet.
  </div>
</body>
</html>
